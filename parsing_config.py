#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Конфигурационный файл для паттернов парсинга.
Позволяет легко модифицировать паттерны без изменения основного кода.
"""

# ============================================================================
# ПАТТЕРНЫ ДЛЯ РЕКВИЗИТОВ ОРГАНИЗАЦИЙ
# ============================================================================

# Паттерны для извлечения ИНН (10 цифр для юр.лиц, 12 для ИП)
INN_PATTERNS = [
    r'ИНН\s*[:\s]*(\d{10,12})',
    r'ИНН:\s*(\d{10,12})',
    r'инн\s+(\d{10,12})',
    r'ИНН\s+ответчика\s*[:\s]*(\d{10,12})',
    r'ИНН\s+истца\s*[:\s]*(\d{10,12})',
]

# Паттерны для извлечения КПП (9 цифр, только для юр.лиц)
KPP_PATTERNS = [
    r'КПП\s*[:\s]*(\d{9})',
    r'КПП:\s*(\d{9})',
    r'кпп\s+(\d{9})',
]

# Паттерны для извлечения ОГРН (13 цифр для юр.лиц, 15 для ИП)
OGRN_PATTERNS = [
    r'ОГРН(?:ИП)?\s*[:\s]*(\d{13,15})',
    r'ОГРН:\s*(\d{13,15})',
    r'огрн\s+(\d{13,15})',
    r'ОГРНИП\s*[:\s]*(\d{15})',
]

# ============================================================================
# ПАТТЕРНЫ ДЛЯ ОРГАНИЗАЦИЙ
# ============================================================================

# Паттерны для юридических лиц (ООО, АО и т.д.)
LEGAL_ENTITY_PATTERNS = [
    r'(?:Обществу|Общество)\s+с\s+ограниченной\s+ответственностью\s*[«"]([^»"]+)[»"]',
    r'ООО\s*[«"]([^»"]+)[»"]',
    r'Общество\s+с\s+ограниченной\s+ответственностью\s+([^\n]+)',
    r'(?:Закрытому|Закрытое)\s+акционерному\s+обществу\s*[«"]([^»"]+)[»"]',
    r'ЗАО\s*[«"]([^»"]+)[»"]',
    r'(?:Публичному|Публичное)\s+акционерному\s+обществу\s*[«"]([^»"]+)[»"]',
    r'ПАО\s*[«"]([^»"]+)[»"]',
]

# Паттерны для индивидуальных предпринимателей
INDIVIDUAL_PATTERNS = [
    r'(?:ИП|Индивидуальный\s+предприниматель)\s+([А-ЯЁ][а-яё]+(?:\s+[А-ЯЁ][а-яё]+){1,2})',
    r'Индивидуальному\s+предпринимателю\s+([А-ЯЁ][а-яё]+(?:\s+[А-ЯЁ][а-яё]+){1,2})',
    r'от\s+Индивидуального\s+предпринимателя\s+([А-ЯЁ][а-яё]+(?:\s+[А-ЯЁ][а-яё]+){1,2})',
]

# ============================================================================
# ПАТТЕРНЫ ДЛЯ АДРЕСОВ
# ============================================================================

ADDRESS_PATTERNS = [
    r'(\d{6},\s*[^,\n]+(?:,[^,\n]+){2,})',
    r'адрес\s*[:\s]*([^,\n]+(?:,[^,\n]+){2,})',
    r'место\s+нахождения\s*[:\s]*([^,\n]+(?:,[^,\n]+){2,})',
    r'юридический\s+адрес\s*[:\s]*([^,\n]+(?:,[^,\n]+){2,})',
]

# ============================================================================
# ПАТТЕРНЫ ДЛЯ ФИНАНСОВЫХ ДАННЫХ
# ============================================================================

# Паттерны для суммы задолженности
DEBT_PATTERNS = [
    r'Стоимость услуг по договор[^0-9]*составила\s*([0-9\s,]+)\s*рубл',
    r'размер задолженности[^0-9]*составляет\s*([0-9\s,]+)\s*рубл',
    r'задолженность[^0-9]*в размере\s*([0-9\s,]+)\s*рубл',
    r'сумма[^0-9]*составляет\s*([0-9\s,]+)\s*рубл',
    r'долг[^0-9]*в размере\s*([0-9\s,]+)\s*рубл',
]

# Паттерны для юридических услуг
LEGAL_FEES_PATTERNS = [
    r'юридические услуги[^0-9]*составляют\s*([0-9\s,]+)\s*рубл',
    r'юридические услуги[^0-9]*в размере\s*([0-9\s,]+)\s*рубл',
    r'оплатил[^0-9]*денежные средства[^0-9]*в размере\s*([0-9\s,]+)\s*рубл',
    r'(\d[\d\s,]*)\s*рубл[а-яё]*\s*-\s*юридические услуги',
]

# Паттерны для процентов
INTEREST_PATTERNS = [
    r'Сумма процентов:\s*([0-9\s,]+)\s*р',
    r'проценты[^0-9]*в размере\s*([0-9\s,]+)\s*рубл',
    r'проценты[^0-9]*составляют\s*([0-9\s,]+)\s*рубл',
]

# Паттерны для срока оплаты (в днях)
PAYMENT_DAYS_PATTERNS = [
    r'в течение\s*(\d{1,3})\s*банковских дней(?!\s*\d{2}\.\d{2}\.\d{4})',
    r'срок оплаты[^0-9]*(\d{1,3})\s*дней(?!\s*\d{2}\.\d{2}\.\d{4})',
    r'оплата[^0-9]*в течение\s*(\d{1,3})\s*дней(?!\s*\d{2}\.\d{2}\.\d{4})',
]

# Паттерны для условий оплаты (текстовое описание)
PAYMENT_TERMS_PATTERNS = [
    r'(Согласно[^\n]*оплата[^\n]*производится[^\n]*)',
    r'(оплата[^\n]*производится[^\n]*)',
    r'(срок[^\n]*оплаты[^\n]*)',
    r'(оплата[^\n]*безналичным[^\n]*расчетом[^\n]*)',
]

# ============================================================================
# ПАТТЕРНЫ ДЛЯ ДАТ
# ============================================================================

# Паттерны для дат в формате ДД.ММ.ГГГГ
DATE_PATTERNS = [
    r'(\d{2}\.\d{2}\.\d{4})(?:\s*г?\.?|)',
    r'от\s+(\d{2}\.\d{2}\.\d{4})',
    r'дата\s*[:\s]*(\d{2}\.\d{2}\.\d{4})',
]

# Паттерны для даты расчета
CALCULATION_DATE_PATTERNS = [
    r'по состоянию на\s*(\d{2}\.\d{2}\.\d{4})\s*г',
    r'на\s*(\d{2}\.\d{2}\.\d{4})\s*г',
    r'расчет[^0-9]*на\s*(\d{2}\.\d{2}\.\d{4})',
]

# Паттерны для крайнего срока оплаты
PAYMENT_DUE_DATE_PATTERNS = [
    r'не позднее\s*(\d{2}\.\d{2}\.\d{4})',
    r'срок оплаты[^0-9]*(\d{2}\.\d{2}\.\d{4})',
]

# ============================================================================
# ПАТТЕРНЫ ДЛЯ ДОКУМЕНТОВ
# ============================================================================

# Паттерны для заявок на перевозку груза
CONTRACT_APPLICATION_PATTERNS = [
    r'заявк[а-я]*\s+на\s+перевозку\s+груза\s+((?:(?:№|No|N)\s*\d+\s+от\s+\d{2}\.\d{2}\.\d{4}[^,]*[,;]?\s*)+)',
    r'(?:договор[\s-]*заявк[аи]?|договор[\s-]*заявк[аи]? на перевозку)[^\n;\.]*№\s*(\d+(?:/\d+)?)[^\n;\.]*от\s*(\d{2}\.\d{2}\.\d{4})',
]

# Паттерны для счетов на оплату
INVOICE_PATTERNS = [
    r'(?:счет[а-яё]* на оплату|счет[а-яё]*)[^\n;\.]*№\s*(\d+)[^\n;\.]*от\s*(\d{2}\.\d{2}\.\d{4})',
    r'счетом\s+на\s+оплату\s+№\s*(\d+)[^\n;\.]*от\s*(\d{2}\.\d{2}\.\d{4})',
]

# Паттерны для УПД и актов
UPD_ACT_PATTERNS = [
    r'(?:УПД|универсальн[а-яё ]*передаточн[а-яё ]*документ[а-яё]*)[^\n;\.]*№\s*(\d+)[^\n;\.]*от\s*(\d{2}\.\d{2}\.\d{4})',
    r'акт[а-яё]* выполненных работ[^\n;\.]*№\s*(\d+)[^\n;\.]*от\s*(\d{2}\.\d{2}\.\d{4})',
    r'акт[а-яё]* оказанных услуг[^\n;\.]*№\s*(\d+)[^\n;\.]*от\s*(\d{2}\.\d{2}\.\d{4})',
]

# Паттерны для накладных
CARGO_DOCS_PATTERNS = [
    r'(?:товарн[а-я]* накладн[а-я]*|транспортн[а-я]* накладн[а-я]*)[^\n;\.]*№\s*(\d+)[^\n;\.]*от\s*(\d{2}\.\d{2}\.\d{4})',
    r'комплект[а-я]*\s+сопроводительных\s+документов',
]

# Паттерны для почтовых уведомлений
POSTAL_PATTERNS = [
    r'почтов[а-я]*\s+уведомлени[а-я]*\s+№\s*(\d+)',
    r'трек[- ]номер[^\n:]*:\s*(\d+)',
]

# ============================================================================
# ПАТТЕРНЫ ДЛЯ ПОДСУДНОСТИ
# ============================================================================

# Паттерны для определения подсудности (из jurisdiction.py)
JURISDICTION_PATTERNS = [
    r'[Пп]одсудност[ьи]\s+спор[а-я]*\s*[—\-:]\s*(.+?)(?:\.|;|\n)',
    r'[Сс]пор[ыа]*\s+(?:разрешаются|рассматриваются)\s+в\s+(.+?)(?:\.|;|\n)',
    r'[Дд]ела\s+(?:рассматриваются|подлежат рассмотрению)\s+в\s+(.+?)(?:\.|;|\n)',
    r'[Вв]\s+случае\s+спора[^\.]*подсудность[^\n]*[—\-:]\s*(.+?)(?:\.|;|\n)',
]

# ============================================================================
# НАСТРОЙКИ ПАРСИНГА
# ============================================================================

# Размер скользящего окна для поиска контекста
SLIDING_WINDOW_SIZE = 15

# Минимальная уверенность для принятия результата (0.0 - 1.0)
MIN_CONFIDENCE = 0.5

# Включить детальное логирование
DEBUG_LOGGING = False

# Использовать pymorphy2 для морфологического анализа
USE_MORPHOLOGY = True

# ============================================================================
# СЛОВАРИ ДЛЯ НОРМАЛИЗАЦИИ
# ============================================================================

# Нормализация организационно-правовых форм
ORG_FORM_NORMALIZATIONS = {
    'Обществу с ограниченной ответственностью': 'Общество с ограниченной ответственностью',
    'Общества с ограниченной ответственностью': 'Общество с ограниченной ответственностью',
    'Индивидуальному предпринимателю': 'Индивидуальный предприниматель',
}

# Сокращения организационно-правовых форм
ORG_FORM_ABBREVIATIONS = {
    'Общество с ограниченной ответственностью': 'ООО',
    'Закрытое акционерное общество': 'ЗАО',
    'Публичное акционерное общество': 'ПАО',
    'Открытое акционерное общество': 'ОАО',
    'Акционерное общество': 'АО',
    'Индивидуальный предприниматель': 'ИП',
}

# Полные формы организационно-правовых форм
ORG_FORM_EXPANSIONS = {
    'ООО': 'Общество с ограниченной ответственностью',
    'ЗАО': 'Закрытое акционерное общество',
    'ПАО': 'Публичное акционерное общество',
    'ОАО': 'Открытое акционерное общество',
    'АО': 'Акционерное общество',
    'ИП': 'Индивидуальный предприниматель',
}

# ============================================================================
# МАРКЕРЫ СЕКЦИЙ ДОКУМЕНТА
# ============================================================================

# Маркеры начала секции ответчика
DEFENDANT_SECTION_MARKERS = [
    'Обществу',
    'ООО',
    'ЗАО',
    'ПАО',
    'ИП',
]

# Маркеры начала секции истца
PLAINTIFF_SECTION_MARKERS = [
    'от',
    'от Общества',
    'от ООО',
    'от Индивидуального предпринимателя',
    'от ИП',
]

# Маркеры начала основного текста требования
REQUIREMENT_MARKERS = [
    'ТРЕБОВАНИЕ',
    'ПРЕТЕНЗИЯ',
    'Требование',
    'Претензия',
]

# ============================================================================
# ПРИОРИТЕТЫ ПАТТЕРНОВ
# ============================================================================

# Приоритеты для извлечения (чем выше, тем приоритетнее)
PATTERN_PRIORITIES = {
    'direct': 10,      # Прямое извлечение по точному паттерну
    'contextual': 8,   # Контекстное извлечение
    'recovered': 5,    # Восстановленные данные
    'fallback': 3,     # Запасной вариант
}

# ============================================================================
# ОБЯЗАТЕЛЬНЫЕ ПОЛЯ
# ============================================================================

# Поля, которые обязательно должны быть извлечены
REQUIRED_FIELDS = [
    'defendant_inn',
    'defendant_name',
    'plaintiff_inn',
    'plaintiff_name',
    'debt',
]

# Поля, которые желательны, но не обязательны
OPTIONAL_FIELDS = [
    'defendant_kpp',
    'defendant_ogrn',
    'defendant_address',
    'plaintiff_kpp',
    'plaintiff_ogrn',
    'plaintiff_address',
    'legal_fees',
    'total_interest',
    'payment_days',
    'payment_terms',
]
